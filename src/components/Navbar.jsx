import React, { useState, useRef, useEffect } from 'react';
import { gsap } from 'gsap';
import { useGSAP } from '@gsap/react';

const Navbar = () => {
  const navRef = useRef(null);
  const [isOpen, setIsOpen] = useState(false);
  const [lastScrollY, setLastScrollY] = useState(0);
  const [showNavbar, setShowNavbar] = useState(true);

  useGSAP(() => {
    gsap.fromTo(navRef.current.querySelector('.logo'),
      { opacity: 0, x: -100 },
      { opacity: 1, x: 0, duration: 0.7, ease: 'power2.inOut', delay: 1.7 }
    );

    gsap.fromTo(navRef.current.querySelector('.button button'),
      { opacity: 0, x: 100 },
      { opacity: 1, x: 0, duration: 0.7, ease: 'power3.out', delay: 2 }
    );

    gsap.fromTo(navRef.current.querySelectorAll('.links p'),
      { opacity: 0, y: -50 },
      {
        opacity: 1,
        y: 0,
        duration: 0.5,
        ease: 'back.out(1.7)',
        stagger: 0.15,
        delay: 2
      }
    );
  }, { scope: navRef });

  useEffect(() => {
    const controlNavbar = () => {
      if (typeof window !== 'undefined') {
        const currentScrollY = window.scrollY;

        if (currentScrollY === 0) {
          setShowNavbar(true);
          setLastScrollY(currentScrollY);
          return;
        }

        if (currentScrollY > lastScrollY && currentScrollY > 100) {
          setShowNavbar(false);
        }
        else if (currentScrollY < lastScrollY) {
          setShowNavbar(true);
        }

        setLastScrollY(currentScrollY);
      }
    };

    window.addEventListener('scroll', controlNavbar);
    return () => {
      window.removeEventListener('scroll', controlNavbar);
    };
  }, [lastScrollY]);

  return (
    <div
      className={`fixed top-0 w-full font-[400] pl-10 pr-10 pt-5 pb-5 z-[999] backdrop-blur-md transition-transform duration-300 ${showNavbar ? 'translate-y-0' : '-translate-y-full'
        }`}
    >
      <div ref={navRef} className="navbar flex justify-between items-center gap-[1.5em] font-['raleway'] z-[999]">
        <div className="logo font-bold text-xl">
          <svg xmlns="http://www.w3.org/2000/svg" width="125" height="40" viewBox="0 0 307 40" fill="none">
            <path d="M4.47656 27.6475C5.86003 28.4287 7.25977 29.1367 8.67578 29.7715C10.1081 30.39 11.5892 30.9189 13.1191 31.3584C14.6491 31.7816 16.2523 32.1071 17.9287 32.335C19.6214 32.5628 21.4199 32.6768 23.3242 32.6768C25.6191 32.6768 27.5723 32.5303 29.1836 32.2373C30.7949 31.9281 32.1051 31.513 33.1143 30.9922C34.1396 30.4551 34.8802 29.8203 35.3359 29.0879C35.8079 28.3555 36.0439 27.5579 36.0439 26.6953C36.0439 25.3118 35.4661 24.2214 34.3105 23.4238C33.1549 22.61 31.3727 22.2031 28.9639 22.2031C27.9059 22.2031 26.791 22.2764 25.6191 22.4229C24.4473 22.5531 23.2591 22.6995 22.0547 22.8623C20.8665 23.0251 19.6865 23.1797 18.5146 23.3262C17.359 23.4564 16.2686 23.5215 15.2432 23.5215C13.5342 23.5215 11.8903 23.3018 10.3115 22.8623C8.74902 22.4229 7.35742 21.7637 6.13672 20.8848C4.93229 20.0059 3.97201 18.9072 3.25586 17.5889C2.53971 16.2705 2.18164 14.7324 2.18164 12.9746C2.18164 11.9329 2.31999 10.8994 2.59668 9.87402C2.88965 8.84863 3.34538 7.87207 3.96387 6.94434C4.59863 6.00033 5.41243 5.12956 6.40527 4.33203C7.39811 3.51823 8.5944 2.81836 9.99414 2.23242C11.4102 1.64648 13.0378 1.19076 14.877 0.865234C16.7324 0.523438 18.8402 0.352539 21.2002 0.352539C22.9092 0.352539 24.6263 0.450195 26.3516 0.645508C28.0768 0.824544 29.7533 1.08496 31.3809 1.42676C33.0247 1.76855 34.6035 2.18359 36.1172 2.67188C37.6309 3.14388 39.0387 3.67285 40.3408 4.25879L36.9473 10.5088C35.873 10.0368 34.7174 9.60547 33.4805 9.21484C32.2435 8.80794 30.9495 8.45801 29.5986 8.16504C28.2477 7.87207 26.848 7.64421 25.3994 7.48145C23.9671 7.30241 22.5023 7.21289 21.0049 7.21289C18.8727 7.21289 17.1149 7.36751 15.7314 7.67676C14.3643 7.986 13.2738 8.38477 12.46 8.87305C11.6462 9.34505 11.0765 9.88216 10.751 10.4844C10.4417 11.0703 10.2871 11.6562 10.2871 12.2422C10.2871 13.3815 10.7998 14.3174 11.8252 15.0498C12.8506 15.766 14.4131 16.124 16.5127 16.124C17.359 16.124 18.3275 16.0671 19.418 15.9531C20.5247 15.8229 21.6803 15.6846 22.8848 15.5381C24.1055 15.3916 25.3424 15.2614 26.5957 15.1475C27.8652 15.0173 29.0941 14.9521 30.2822 14.9521C32.5283 14.9521 34.514 15.2044 36.2393 15.709C37.9808 16.2135 39.4375 16.9378 40.6094 17.8818C41.7812 18.8096 42.6683 19.9408 43.2705 21.2754C43.8727 22.5938 44.1738 24.0749 44.1738 25.7188C44.1738 27.916 43.6611 29.8773 42.6357 31.6025C41.6266 33.3115 40.1781 34.7601 38.29 35.9482C36.4183 37.1201 34.1559 38.0153 31.5029 38.6338C28.8499 39.236 25.8958 39.5371 22.6406 39.5371C20.4922 39.5371 18.3926 39.3988 16.3418 39.1221C14.291 38.8617 12.3216 38.4873 10.4336 37.999C8.56185 37.4945 6.77148 36.9004 5.0625 36.2168C3.36979 35.5169 1.79915 34.752 0.350586 33.9219L4.47656 27.6475ZM50.4482 19.8105C50.4482 16.9297 50.9772 14.293 52.0352 11.9004C53.0931 9.50781 54.5742 7.45703 56.4785 5.74805C58.3991 4.02279 60.694 2.68815 63.3633 1.74414C66.0488 0.80013 69.0192 0.328125 72.2744 0.328125C75.5133 0.328125 78.4756 0.80013 81.1611 1.74414C83.8467 2.68815 86.1416 4.02279 88.0459 5.74805C89.9665 7.45703 91.4557 9.50781 92.5137 11.9004C93.5716 14.293 94.1006 16.9297 94.1006 19.8105C94.1006 22.7077 93.5716 25.3688 92.5137 27.7939C91.4557 30.2028 89.9665 32.278 88.0459 34.0195C86.1416 35.7611 83.8467 37.1201 81.1611 38.0967C78.4756 39.057 75.5133 39.5371 72.2744 39.5371C69.0192 39.5371 66.0488 39.057 63.3633 38.0967C60.694 37.1201 58.3991 35.7611 56.4785 34.0195C54.5742 32.278 53.0931 30.2028 52.0352 27.7939C50.9772 25.3688 50.4482 22.7077 50.4482 19.8105ZM58.1875 19.8105C58.1875 21.7799 58.5374 23.554 59.2373 25.1328C59.9535 26.7116 60.9382 28.0625 62.1914 29.1855C63.4609 30.2923 64.9502 31.1468 66.6592 31.749C68.3844 32.3512 70.2562 32.6523 72.2744 32.6523C74.2926 32.6523 76.1562 32.3512 77.8652 31.749C79.5905 31.1468 81.0798 30.2923 82.333 29.1855C83.5863 28.0625 84.571 26.7116 85.2871 25.1328C86.0033 23.554 86.3613 21.7799 86.3613 19.8105C86.3613 17.8411 86.0033 16.0752 85.2871 14.5127C84.571 12.9502 83.5863 11.6318 82.333 10.5576C81.0798 9.46712 79.5905 8.63704 77.8652 8.06738C76.1562 7.49772 74.2926 7.21289 72.2744 7.21289C70.2562 7.21289 68.3844 7.49772 66.6592 8.06738C64.9502 8.63704 63.4609 9.46712 62.1914 10.5576C60.9382 11.6318 59.9535 12.9502 59.2373 14.5127C58.5374 16.0752 58.1875 17.8411 58.1875 19.8105ZM102.646 0.84082H110.385L134.164 13.292V0.84082H141.903V39H134.164V21.4951L110.385 9.11719V39H102.646V0.84082ZM151.718 0.84082H159.506V39H151.718V0.84082ZM167.147 19.8105C167.147 16.9297 167.676 14.293 168.734 11.9004C169.792 9.50781 171.273 7.45703 173.178 5.74805C175.098 4.02279 177.393 2.68815 180.062 1.74414C182.748 0.80013 185.718 0.328125 188.974 0.328125C192.213 0.328125 195.175 0.80013 197.86 1.74414C200.546 2.68815 202.841 4.02279 204.745 5.74805C206.666 7.45703 208.155 9.50781 209.213 11.9004C210.271 14.293 210.8 16.9297 210.8 19.8105C210.8 22.3822 210.377 24.7666 209.53 26.9639C208.7 29.1449 207.52 31.0817 205.99 32.7744L212.851 39H203.036L200.668 36.8516C199.008 37.7305 197.201 38.3978 195.248 38.8535C193.295 39.3092 191.203 39.5371 188.974 39.5371C185.718 39.5371 182.748 39.057 180.062 38.0967C177.393 37.1201 175.098 35.7611 173.178 34.0195C171.273 32.278 169.792 30.2028 168.734 27.7939C167.676 25.3688 167.147 22.7077 167.147 19.8105ZM174.887 19.8105C174.887 21.7799 175.237 23.554 175.937 25.1328C176.653 26.7116 177.637 28.0625 178.891 29.1855C180.16 30.2923 181.649 31.1468 183.358 31.749C185.084 32.3512 186.955 32.6523 188.974 32.6523C191.138 32.6523 193.116 32.3105 194.906 31.627L183.969 21.7148H193.783L200.424 27.7451C201.254 26.6872 201.897 25.499 202.353 24.1807C202.825 22.846 203.061 21.3893 203.061 19.8105C203.061 17.8411 202.702 16.0752 201.986 14.5127C201.27 12.9502 200.285 11.6318 199.032 10.5576C197.779 9.46712 196.29 8.63704 194.564 8.06738C192.855 7.49772 190.992 7.21289 188.974 7.21289C186.955 7.21289 185.084 7.49772 183.358 8.06738C181.649 8.63704 180.16 9.46712 178.891 10.5576C177.637 11.6318 176.653 12.9502 175.937 14.5127C175.237 16.0752 174.887 17.8411 174.887 19.8105ZM217.953 0.84082H225.692V21.8613C225.692 23.5866 225.928 25.1247 226.4 26.4756C226.872 27.8102 227.572 28.9414 228.5 29.8691C229.444 30.7969 230.608 31.5049 231.991 31.9932C233.375 32.4652 234.986 32.7012 236.825 32.7012C238.648 32.7012 240.251 32.4652 241.635 31.9932C243.035 31.5049 244.198 30.7969 245.126 29.8691C246.07 28.9414 246.778 27.8102 247.25 26.4756C247.722 25.1247 247.958 23.5866 247.958 21.8613V0.84082H255.697V22.7891C255.697 25.2956 255.274 27.5742 254.428 29.625C253.581 31.6758 252.353 33.4336 250.741 34.8984C249.13 36.3633 247.152 37.4945 244.809 38.292C242.481 39.0895 239.82 39.4883 236.825 39.4883C233.83 39.4883 231.161 39.0895 228.817 38.292C226.49 37.4945 224.521 36.3633 222.909 34.8984C221.298 33.4336 220.069 31.6758 219.223 29.625C218.376 27.5742 217.953 25.2956 217.953 22.7891V0.84082ZM262.899 19.8105C262.899 16.9297 263.428 14.293 264.486 11.9004C265.544 9.50781 267.025 7.45703 268.93 5.74805C270.85 4.02279 273.145 2.68815 275.814 1.74414C278.5 0.80013 281.47 0.328125 284.726 0.328125C287.965 0.328125 290.927 0.80013 293.612 1.74414C296.298 2.68815 298.593 4.02279 300.497 5.74805C302.418 7.45703 303.907 9.50781 304.965 11.9004C306.023 14.293 306.552 16.9297 306.552 19.8105C306.552 22.7077 306.023 25.3688 304.965 27.7939C303.907 30.2028 302.418 32.278 300.497 34.0195C298.593 35.7611 296.298 37.1201 293.612 38.0967C290.927 39.057 287.965 39.5371 284.726 39.5371C281.47 39.5371 278.5 39.057 275.814 38.0967C273.145 37.1201 270.85 35.7611 268.93 34.0195C267.025 32.278 265.544 30.2028 264.486 27.7939C263.428 25.3688 262.899 22.7077 262.899 19.8105ZM270.639 19.8105C270.639 21.7799 270.989 23.554 271.688 25.1328C272.405 26.7116 273.389 28.0625 274.643 29.1855C275.912 30.2923 277.401 31.1468 279.11 31.749C280.836 32.3512 282.707 32.6523 284.726 32.6523C286.744 32.6523 288.607 32.3512 290.316 31.749C292.042 31.1468 293.531 30.2923 294.784 29.1855C296.037 28.0625 297.022 26.7116 297.738 25.1328C298.454 23.554 298.812 21.7799 298.812 19.8105C298.812 17.8411 298.454 16.0752 297.738 14.5127C297.022 12.9502 296.037 11.6318 294.784 10.5576C293.531 9.46712 292.042 8.63704 290.316 8.06738C288.607 7.49772 286.744 7.21289 284.726 7.21289C282.707 7.21289 280.836 7.49772 279.11 8.06738C277.401 8.63704 275.912 9.46712 274.643 10.5576C273.389 11.6318 272.405 12.9502 271.688 14.5127C270.989 16.0752 270.639 17.8411 270.639 19.8105Z" fill="white" />
          </svg>
        </div>

        <div className="hidden md:flex links gap-10">
          <p className='cursor-pointer hover:text-gray-300 transition-colors'>Product</p>
          <p className='cursor-pointer hover:text-gray-300 transition-colors'>New Product</p>
          <p className='cursor-pointer hover:text-gray-300 transition-colors'>Pricing</p>
          <p className='cursor-pointer hover:text-gray-300 transition-colors'>Customer</p>
        </div>

        <div className="hidden md:block button">
          <button className='pt-[0.5em] pb-[0.5em] pr-[1.5em] pl-[1.5em] border rounded-[50px] cursor-pointer hover:bg-white hover:text-black transition-colors'>
            Buy Now!
          </button>
        </div>

        <div className="md:hidden">
          <button onClick={() => setIsOpen(!isOpen)} className="focus:outline-none">
            <svg
              className="w-6 h-6 cursor-pointer"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
            >
              {isOpen ? (
                <path
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  strokeWidth="2"
                  d="M6 18L18 6M6 6l12 12"
                />
              ) : (
                <path
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  strokeWidth="2"
                  d="M4 6h16M4 12h16m-16 6h16"
                />
              )}
            </svg>
          </button>
        </div>
      </div>

      {isOpen && (
        <div className="md:hidden mt-4">
          <div className="flex flex-col items-center p-4 gap-4">
            <p className='cursor-pointer w-full text-center p-2 hover:bg-gray-100 hover:text-black rounded'>Product</p>
            <p className='cursor-pointer w-full text-center p-2 hover:bg-gray-100 hover:text-black rounded'>New Product</p>
            <p className='cursor-pointer w-full text-center p-2 hover:bg-gray-100 hover:text-black rounded'>Pricing</p>
            <p className='cursor-pointer w-full text-center p-2 hover:bg-gray-100 hover:text-black rounded'>Customer</p>
          </div>
        </div>
      )}
    </div>
  );
};

export default Navbar;